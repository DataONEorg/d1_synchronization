<?xml version="1.0" encoding="UTF-8"?>

<!--
    Document   : LogReaderTestCase-context.xml
    Created on : June 4, 2010, 1:58 AM
    Author     : rwaltz
    Description:
        Purpose of the document follows.
-->

<beans  default-init-method="init"  xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

    <bean id="log4jInitialization"
     class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
     <property name="targetClass"
      value="org.springframework.util.Log4jConfigurer" />
       <property name="targetMethod" value="initLogging" />
        <property name="arguments">
        <list>
          <value>classpath:org/dataone/cn/batch/proto/packager/log4j.properties</value>
         </list>
       </property>
      </bean>
      
   <bean id="testPackageHarvestDirectoryResource" class="org.springframework.core.io.ClassPathResource">
       <constructor-arg value="/org/dataone/cn/batch/proto/packager"/>
   </bean>
    <bean id="testPackageHarvestDirectoryFile"
      factory-bean="testPackageHarvestDirectoryResource"
      factory-method="getFile"/>

    <bean id="testPackageHarvestDirectoryString"
        factory-bean="testPackageHarvestDirectoryFile"
        factory-method="getAbsolutePath" />
<!--   <bean id="testPackageHarvestDirectory" class="org.springframework.core.io.ClassPathResource">
       <constructor-arg value="/org/dataone/cn/batch/proto/packager/persistant.cache"/>
   </bean> -->
   <bean id="metadataPackageEventAccess" class="org.dataone.cn.batch.utils.MetadataPackageAccess">
        <property name="logFilePersistAccessDataPath" ref="testPackageHarvestDirectoryString"/>
        <property name="logFilePersistAccessDataName" ref="testLogFilePersistDataName" />
        <property name="logFilePersistPendingDataName" ref="testLogFileReplicationDataName" />
        <property name="logFilePersistPendingDataPath" ref="testPackageHarvestDirectoryString" />
   </bean>
   
    <bean id="replicationLogReader" class="org.dataone.cn.batch.proto.packager.ReplicationLogReader">
        <property name="eventLogFileName" value="test-replication.log" />
        <property name="eventLogFilePath" ref="testPackageHarvestDirectoryString"/>
        <property name="metadataPackageAccess" ref="metadataPackageEventAccess" />
    </bean>
    <bean id="testLogFilePersistDataName" class="java.lang.String">
        <constructor-arg value="persistent2.cache" />
    </bean>
    <bean id="testLogFileReplicationDataName" class="java.lang.String">
        <constructor-arg value="replication.index" />
    </bean>
</beans>